@page
@model WebApplication1.Pages.IndexModel
@{
    ViewData["Title"] = "Gray-em's Favorite Songs";
}

<head>
    <link rel="stylesheet" href="~/css/styles.css" />
</head>

<h1 class="title">@ViewData["Title"]</h1>

<div class="video-grid">
    @foreach (var v in Model.Videos)
    {
        <div class="video-card" style="animation-delay:@(Model.Videos.IndexOf(v) * 0.15)s">
            <iframe src="@v.EmbedUrl"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin"
                    allowfullscreen>
            </iframe>
            <h3 style="text-align:center; margin-top:15px;">@v.Title</h3>
        </div>
    }
</div>


<!-- Modal for video -->
<div id="videoModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <iframe id="modalVideo" src="" allowfullscreen></iframe>
    </div>
</div>
<script>
    const modal = document.getElementById("videoModal");
    const modalVideo = document.getElementById("modalVideo");
    const closeBtn = document.querySelector(".close");

    document.querySelectorAll(".video-card").forEach(card => {
        card.addEventListener("click", () => {
            const iframe = card.querySelector("iframe");
            modalVideo.src = iframe.src; // copy video URL to modal
            modal.style.display = "block";
        });
    });

    closeBtn.addEventListener("click", () => {
        modal.style.display = "none";
        modalVideo.src = ""; // stop video playback
    });

    window.addEventListener("click", (e) => {
        if (e.target === modal) {
            modal.style.display = "none";
            modalVideo.src = "";
        }
    });
</script>
